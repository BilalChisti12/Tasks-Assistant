<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager with Email Reminders</title>
    <style>
        /* Design System Variables */
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-400: rgba(230, 129, 97, 1);
            --color-orange-500: rgba(168, 75, 47, 1);
            
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-border: rgba(94, 82, 64, 0.2);
            --color-card-border: rgba(94, 82, 64, 0.12);
            
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 30px;
            
            --space-4: 4px;
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            
            --radius-base: 8px;
            --radius-lg: 12px;
            --radius-full: 9999px;
            
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
            
            --duration-fast: 150ms;
            --duration-normal: 250ms;
        }
        
        @media (prefers-color-scheme: dark) {
            :root {
                --color-background: var(--color-charcoal-700);
                --color-surface: var(--color-charcoal-800);
                --color-text: var(--color-gray-200);
                --color-text-secondary: rgba(167, 169, 169, 0.7);
                --color-primary: var(--color-teal-300);
                --color-border: rgba(119, 124, 124, 0.3);
                --color-card-border: rgba(119, 124, 124, 0.2);
            }
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: var(--font-family-base);
            font-size: var(--font-size-base);
            line-height: 1.5;
            color: var(--color-text);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: var(--space-16);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: var(--space-32);
            color: white;
        }
        
        .header h1 {
            font-size: var(--font-size-4xl);
            font-weight: 700;
            margin-bottom: var(--space-8);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .header p {
            font-size: var(--font-size-lg);
            opacity: 0.95;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--space-8);
            margin-top: var(--space-12);
            padding: var(--space-8) var(--space-16);
            background: rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Backend Notice */
        .backend-notice {
            background: rgba(255, 255, 255, 0.95);
            border-left: 4px solid #f59e0b;
            padding: var(--space-16);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-24);
            box-shadow: var(--shadow-md);
        }
        
        .backend-notice h3 {
            color: #f59e0b;
            font-size: var(--font-size-lg);
            margin-bottom: var(--space-8);
        }
        
        .backend-notice p {
            color: var(--color-slate-900);
            font-size: var(--font-size-sm);
        }
        
        /* Add Task Form */
        .add-task-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            margin-bottom: var(--space-24);
            box-shadow: var(--shadow-lg);
        }
        
        .add-task-card h2 {
            font-size: var(--font-size-2xl);
            color: var(--color-slate-900);
            margin-bottom: var(--space-20);
        }
        
        .form-grid {
            display: grid;
            gap: var(--space-16);
        }
        
        @media (min-width: 768px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-group.full-width {
                grid-column: 1 / -1;
            }
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-label {
            font-size: var(--font-size-sm);
            font-weight: 600;
            color: var(--color-slate-900);
            margin-bottom: var(--space-8);
        }
        
        .form-label.required::after {
            content: ' *';
            color: #ef4444;
        }
        
        .form-input,
        .form-textarea,
        .form-select {
            padding: var(--space-12);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-family: inherit;
            color: var(--color-slate-900);
            background: white;
            transition: all var(--duration-fast);
        }
        
        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(33, 128, 141, 0.1);
        }
        
        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-error {
            color: #ef4444;
            font-size: var(--font-size-sm);
            margin-top: var(--space-4);
        }
        
        .btn {
            padding: var(--space-12) var(--space-24);
            border: none;
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--duration-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--space-8);
            justify-content: center;
        }
        
        .btn-primary {
            background: var(--color-primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-large {
            padding: var(--space-16) var(--space-32);
            font-size: var(--font-size-lg);
        }
        
        /* Task List Section */
        .task-list-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            box-shadow: var(--shadow-lg);
        }
        
        .task-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-16);
            margin-bottom: var(--space-24);
        }
        
        .task-list-header h2 {
            font-size: var(--font-size-2xl);
            color: var(--color-slate-900);
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: var(--space-8);
            border-bottom: 2px solid var(--color-border);
            margin-bottom: var(--space-20);
        }
        
        .tab {
            padding: var(--space-12) var(--space-20);
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            cursor: pointer;
            font-size: var(--font-size-base);
            font-weight: 500;
            color: var(--color-text-secondary);
            transition: all var(--duration-fast);
        }
        
        .tab:hover {
            color: var(--color-primary);
        }
        
        .tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }
        
        /* Search and Sort */
        .controls {
            display: flex;
            gap: var(--space-12);
            flex-wrap: wrap;
            margin-bottom: var(--space-20);
        }
        
        .search-input {
            flex: 1;
            min-width: 200px;
            padding: var(--space-12);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
        }
        
        .sort-select {
            padding: var(--space-12);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            background: white;
        }
        
        /* Task Items */
        .task-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-16);
        }
        
        .task-item {
            border: 2px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-16);
            background: white;
            transition: all var(--duration-normal);
            animation: slideIn var(--duration-normal);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .task-item.new-task {
            animation: highlight 2s;
        }
        
        @keyframes highlight {
            0%, 100% { background: white; }
            50% { background: rgba(33, 128, 141, 0.1); }
        }
        
        .task-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .task-item.completed {
            opacity: 0.7;
        }
        
        .task-item.overdue {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.02);
        }
        
        .task-item.due-today {
            border-color: #ea580c;
            background: rgba(234, 88, 12, 0.02);
        }
        
        .task-item.due-soon {
            border-color: #ca8a04;
            background: rgba(202, 138, 4, 0.02);
        }
        
        .task-header {
            display: flex;
            gap: var(--space-12);
            margin-bottom: var(--space-12);
        }
        
        .task-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .task-content {
            flex: 1;
        }
        
        .task-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--color-slate-900);
            margin-bottom: var(--space-8);
        }
        
        .task-item.completed .task-title {
            text-decoration: line-through;
            color: var(--color-text-secondary);
        }
        
        .task-description {
            color: var(--color-text-secondary);
            font-size: var(--font-size-sm);
            margin-bottom: var(--space-12);
        }
        
        .task-meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-12);
            align-items: center;
            font-size: var(--font-size-sm);
        }
        
        .task-email {
            color: var(--color-text-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }
        
        .task-deadline {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            font-weight: 500;
        }
        
        .task-deadline.overdue {
            color: #dc2626;
        }
        
        .task-deadline.due-today {
            color: #ea580c;
        }
        
        .task-deadline.due-soon {
            color: #ca8a04;
        }
        
        .priority-badge {
            padding: var(--space-4) var(--space-12);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .priority-high {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
        
        .priority-medium {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
        }
        
        .priority-low {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }
        
        .task-actions {
            display: flex;
            gap: var(--space-8);
            margin-top: var(--space-12);
        }
        
        .btn-icon {
            padding: var(--space-8) var(--space-12);
            border: 1px solid var(--color-border);
            background: white;
            border-radius: var(--radius-base);
            cursor: pointer;
            transition: all var(--duration-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--space-4);
            font-size: var(--font-size-sm);
        }
        
        .btn-icon:hover {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }
        
        .btn-delete:hover {
            background: #ef4444;
            border-color: #ef4444;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--space-16);
        }
        
        /* Statistics */
        .statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-16);
            margin-top: var(--space-24);
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: var(--radius-lg);
            padding: var(--space-16);
            text-align: center;
            box-shadow: var(--shadow-sm);
        }
        
        .stat-value {
            font-size: var(--font-size-3xl);
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: var(--space-4);
        }
        
        .stat-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: var(--space-16);
            opacity: 0;
            animation: fadeIn var(--duration-normal) forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .modal {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: slideUp var(--duration-normal);
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(20px);
            }
            to {
                transform: translateY(0);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-20);
        }
        
        .modal-title {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--color-slate-900);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--color-text-secondary);
            padding: var(--space-4);
            line-height: 1;
        }
        
        .modal-actions {
            display: flex;
            gap: var(--space-12);
            justify-content: flex-end;
            margin-top: var(--space-20);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }
        
        .btn-secondary:hover {
            background: var(--color-border);
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: var(--space-20);
            right: var(--space-20);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: var(--space-12);
        }
        
        .toast {
            background: white;
            padding: var(--space-16);
            border-radius: var(--radius-base);
            box-shadow: var(--shadow-lg);
            min-width: 300px;
            display: flex;
            align-items: center;
            gap: var(--space-12);
            animation: slideInRight var(--duration-normal);
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .toast-success {
            border-left: 4px solid #10b981;
        }
        
        .toast-error {
            border-left: 4px solid #ef4444;
        }
        
        .toast-icon {
            font-size: 20px;
        }
        
        .toast-message {
            flex: 1;
            font-size: var(--font-size-sm);
            color: var(--color-slate-900);
        }
        
        /* Responsive */
        @media (max-width: 767px) {
            body {
                padding: var(--space-8);
            }
            
            .header h1 {
                font-size: var(--font-size-2xl);
            }
            
            .header p {
                font-size: var(--font-size-base);
            }
            
            .add-task-card,
            .task-list-card {
                padding: var(--space-16);
            }
            
            .task-item {
                padding: var(--space-12);
            }
            
            .toast {
                min-width: 250px;
            }
            
            .toast-container {
                right: var(--space-12);
                top: var(--space-12);
            }
        }
        
        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        *:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>Task Manager with Email Reminders</h1>
            <p>Stay organized with deadline notifications sent directly to your email</p>
            <div class="status-indicator">
                <span class="status-dot"></span>
                <span>Frontend Demo Active</span>
            </div>
        </header>
        
        <!-- Backend Notice -->
        <div class="backend-notice">
            <h3>⚠️ Frontend Demo Only</h3>
            <p>This is a frontend demonstration. Email reminders require the Node.js backend setup with email service configuration (SMTP/SendGrid) and a job scheduler (node-cron/Bull/Agenda). Tasks are stored in memory only for this session.</p>
        </div>
        
        <!-- Add Task Form -->
        <div class="add-task-card">
            <h2>Add New Task</h2>
            <form id="addTaskForm" class="form-grid">
                <div class="form-group">
                    <label for="taskTitle" class="form-label required">Task Title</label>
                    <input 
                        type="text" 
                        id="taskTitle" 
                        class="form-input" 
                        placeholder="Enter task title"
                        required
                        minlength="3"
                        maxlength="200"
                    >
                    <span class="form-error" id="titleError"></span>
                </div>
                
                <div class="form-group">
                    <label for="taskEmail" class="form-label required">Email Address</label>
                    <input 
                        type="email" 
                        id="taskEmail" 
                        class="form-input" 
                        placeholder="your@email.com"
                        required
                    >
                    <span class="form-error" id="emailError"></span>
                </div>
                
                <div class="form-group full-width">
                    <label for="taskDescription" class="form-label">Description</label>
                    <textarea 
                        id="taskDescription" 
                        class="form-textarea" 
                        placeholder="Add additional details (optional)"
                    ></textarea>
                </div>
                
                <div class="form-group">
                    <label for="taskDeadlineDate" class="form-label">Deadline Date</label>
                    <input 
                        type="date" 
                        id="taskDeadlineDate" 
                        class="form-input"
                    >
                </div>
                
                <div class="form-group">
                    <label for="taskDeadlineTime" class="form-label">Deadline Time</label>
                    <input 
                        type="time" 
                        id="taskDeadlineTime" 
                        class="form-input"
                    >
                </div>
                
                <div class="form-group">
                    <label for="taskPriority" class="form-label">Priority</label>
                    <select id="taskPriority" class="form-select">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                
                <div class="form-group full-width">
                    <button type="submit" class="btn btn-primary btn-large">
                        <span>➕</span>
                        <span>Add Task</span>
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Task List -->
        <div class="task-list-card">
            <div class="task-list-header">
                <h2>My Tasks</h2>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" data-tab="all">All Tasks</button>
                <button class="tab" data-tab="active">Active</button>
                <button class="tab" data-tab="completed">Completed</button>
            </div>
            
            <!-- Controls -->
            <div class="controls">
                <input 
                    type="text" 
                    id="searchInput" 
                    class="search-input" 
                    placeholder="Search tasks..."
                    aria-label="Search tasks"
                >
                <select id="sortSelect" class="sort-select" aria-label="Sort tasks">
                    <option value="deadline-asc">Deadline (Earliest First)</option>
                    <option value="deadline-desc">Deadline (Latest First)</option>
                    <option value="priority-high">Priority (High to Low)</option>
                    <option value="priority-low">Priority (Low to High)</option>
                    <option value="created-desc">Recently Added</option>
                    <option value="created-asc">Oldest First</option>
                </select>
            </div>
            
            <!-- Task List -->
            <div id="taskList" class="task-list">
                <!-- Tasks will be inserted here -->
            </div>
        </div>
        
        <!-- Statistics -->
        <div class="statistics">
            <div class="stat-card">
                <div class="stat-value" id="statTotal">0</div>
                <div class="stat-label">Total Tasks</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="statActive">0</div>
                <div class="stat-label">Active</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="statCompleted">0</div>
                <div class="stat-label">Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="statOverdue">0</div>
                <div class="stat-label">Overdue</div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>
    
    <!-- Edit Modal (will be created dynamically) -->
    
    <!-- Delete Confirmation Modal (will be created dynamically) -->
    
    <script>
        // Task Manager Application
        // Note: Using in-memory storage (tasks persist only during the session)
        let tasks = [];
        let currentTab = 'all';
        let searchQuery = '';
        let sortOrder = 'deadline-asc';
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            loadTasks();
            initializeEventListeners();
            renderTasks();
            updateStatistics();
        });
        
        // Load tasks - initialize with demo data
        function loadTasks() {
            // Initialize with demo data
            const now = new Date();
            tasks = [
                {
                    id: 'task_001',
                    title: 'Complete project proposal',
                    description: 'Finalize and submit the Q1 project proposal to management',
                    email: 'user@example.com',
                    deadline: new Date(now.getTime() + 24 * 60 * 60 * 1000).toISOString(), // Tomorrow
                    priority: 'high',
                    completed: false,
                    notified: false,
                    createdAt: now.toISOString(),
                    updatedAt: now.toISOString()
                },
                {
                    id: 'task_002',
                    title: 'Team meeting preparation',
                    description: 'Prepare slides and agenda for weekly team sync',
                    email: 'team@example.com',
                    deadline: new Date(now.getTime() + 3 * 24 * 60 * 60 * 1000).toISOString(), // 3 days
                    priority: 'medium',
                    completed: false,
                    notified: false,
                    createdAt: now.toISOString(),
                    updatedAt: now.toISOString()
                },
                {
                    id: 'task_003',
                    title: 'Review documentation',
                    description: 'Review and update API documentation',
                    email: 'review@example.com',
                    deadline: new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000).toISOString(), // 1 week
                    priority: 'low',
                    completed: false,
                    notified: false,
                    createdAt: now.toISOString(),
                    updatedAt: now.toISOString()
                }
            ];
        }
        
        // Save tasks (in-memory only)
        function saveTasks() {
            // Tasks are saved in memory only
            console.log('Tasks updated:', tasks.length, 'total tasks');
        }
        
        // Initialize event listeners
        function initializeEventListeners() {
            // Add task form
            document.getElementById('addTaskForm').addEventListener('submit', handleAddTask);
            
            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', handleTabClick);
            });
            
            // Search
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', debounce(handleSearch, 300));
            
            // Sort
            document.getElementById('sortSelect').addEventListener('change', handleSort);
        }
        
        // Handle add task form submission
        function handleAddTask(e) {
            e.preventDefault();
            
            // Get form values
            const title = document.getElementById('taskTitle').value.trim();
            const email = document.getElementById('taskEmail').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const deadlineDate = document.getElementById('taskDeadlineDate').value;
            const deadlineTime = document.getElementById('taskDeadlineTime').value;
            const priority = document.getElementById('taskPriority').value;
            
            // Validate
            if (!validateTaskForm(title, email)) {
                return;
            }
            
            // Create deadline
            let deadline = null;
            if (deadlineDate) {
                const timeStr = deadlineTime || '23:59';
                deadline = new Date(`${deadlineDate}T${timeStr}:00`).toISOString();
            }
            
            // Create task
            const task = {
                id: `task_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                title,
                description,
                email,
                deadline,
                priority,
                completed: false,
                notified: false,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            tasks.unshift(task);
            saveTasks();
            renderTasks();
            updateStatistics();
            
            // Reset form
            document.getElementById('addTaskForm').reset();
            
            // Show success toast
            showToast('Task added successfully!', 'success');
            
            // Scroll to task list and highlight new task
            setTimeout(() => {
                const taskElement = document.querySelector(`[data-task-id="${task.id}"]`);
                if (taskElement) {
                    taskElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    taskElement.classList.add('new-task');
                    setTimeout(() => taskElement.classList.remove('new-task'), 2000);
                }
            }, 100);
        }
        
        // Validate task form
        function validateTaskForm(title, email) {
            let isValid = true;
            
            // Clear errors
            document.getElementById('titleError').textContent = '';
            document.getElementById('emailError').textContent = '';
            
            // Validate title
            if (title.length < 3) {
                document.getElementById('titleError').textContent = 'Title must be at least 3 characters';
                isValid = false;
            } else if (title.length > 200) {
                document.getElementById('titleError').textContent = 'Title must be less than 200 characters';
                isValid = false;
            }
            
            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                document.getElementById('emailError').textContent = 'Please enter a valid email address';
                isValid = false;
            }
            
            return isValid;
        }
        
        // Handle tab click
        function handleTabClick(e) {
            const tab = e.target.dataset.tab;
            currentTab = tab;
            
            // Update active tab
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            e.target.classList.add('active');
            
            renderTasks();
        }
        
        // Handle search
        function handleSearch(e) {
            searchQuery = e.target.value.toLowerCase().trim();
            renderTasks();
        }
        
        // Handle sort
        function handleSort(e) {
            sortOrder = e.target.value;
            renderTasks();
        }
        
        // Render tasks
        function renderTasks() {
            const taskList = document.getElementById('taskList');
            
            // Filter tasks
            let filteredTasks = tasks.filter(task => {
                // Filter by tab
                if (currentTab === 'active' && task.completed) return false;
                if (currentTab === 'completed' && !task.completed) return false;
                
                // Filter by search
                if (searchQuery) {
                    const searchLower = searchQuery.toLowerCase();
                    return task.title.toLowerCase().includes(searchLower) ||
                           (task.description && task.description.toLowerCase().includes(searchLower));
                }
                
                return true;
            });
            
            // Sort tasks
            filteredTasks = sortTasks(filteredTasks, sortOrder);
            
            // Render
            if (filteredTasks.length === 0) {
                taskList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">📋</div>
                        <p>No tasks found. Add a new task to get started!</p>
                    </div>
                `;
            } else {
                taskList.innerHTML = filteredTasks.map(task => renderTaskItem(task)).join('');
                
                // Add event listeners
                filteredTasks.forEach(task => {
                    const checkbox = document.querySelector(`#checkbox-${task.id}`);
                    checkbox.addEventListener('change', () => handleToggleComplete(task.id));
                    
                    const editBtn = document.querySelector(`#edit-${task.id}`);
                    editBtn.addEventListener('click', () => handleEditTask(task.id));
                    
                    const deleteBtn = document.querySelector(`#delete-${task.id}`);
                    deleteBtn.addEventListener('click', () => handleDeleteTask(task.id));
                });
            }
        }
        
        // Render single task item
        function renderTaskItem(task) {
            const deadlineInfo = getDeadlineInfo(task.deadline);
            const deadlineClass = getDeadlineClass(task.deadline, task.completed);
            
            return `
                <div class="task-item ${task.completed ? 'completed' : ''} ${deadlineClass}" data-task-id="${task.id}">
                    <div class="task-header">
                        <input 
                            type="checkbox" 
                            id="checkbox-${task.id}" 
                            class="task-checkbox" 
                            ${task.completed ? 'checked' : ''}
                            aria-label="Mark task as ${task.completed ? 'incomplete' : 'complete'}"
                        >
                        <div class="task-content">
                            <h3 class="task-title">${escapeHtml(task.title)}</h3>
                            ${task.description ? `<p class="task-description">${escapeHtml(task.description)}</p>` : ''}
                            <div class="task-meta">
                                <span class="task-email">
                                    <span>📧</span>
                                    <span>${escapeHtml(task.email)}</span>
                                </span>
                                ${task.deadline ? `
                                    <span class="task-deadline ${deadlineInfo.class}">
                                        <span>⏰</span>
                                        <span>${deadlineInfo.text}</span>
                                    </span>
                                ` : ''}
                                <span class="priority-badge priority-${task.priority}">
                                    ${task.priority}
                                </span>
                            </div>
                            <div class="task-actions">
                                <button id="edit-${task.id}" class="btn-icon" aria-label="Edit task">
                                    <span>✏️</span>
                                    <span>Edit</span>
                                </button>
                                <button id="delete-${task.id}" class="btn-icon btn-delete" aria-label="Delete task">
                                    <span>🗑️</span>
                                    <span>Delete</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Get deadline info
        function getDeadlineInfo(deadline) {
            if (!deadline) return { text: 'No deadline', class: '' };
            
            const now = new Date();
            const deadlineDate = new Date(deadline);
            const diff = deadlineDate - now;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor(diff / (1000 * 60));
            
            let text = '';
            let cssClass = '';
            
            if (diff < 0) {
                // Overdue
                const absDays = Math.abs(days);
                const absHours = Math.abs(hours);
                if (absDays > 0) {
                    text = `Overdue by ${absDays} day${absDays > 1 ? 's' : ''}`;
                } else if (absHours > 0) {
                    text = `Overdue by ${absHours} hour${absHours > 1 ? 's' : ''}`;
                } else {
                    text = 'Overdue';
                }
                cssClass = 'overdue';
            } else if (days === 0 && hours < 24) {
                // Due today
                text = `Due today at ${deadlineDate.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}`;
                cssClass = 'due-today';
            } else if (days <= 7) {
                // Due this week
                text = `Due in ${days} day${days > 1 ? 's' : ''}`;
                cssClass = 'due-soon';
            } else {
                // Future
                text = deadlineDate.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric',
                    year: deadlineDate.getFullYear() !== now.getFullYear() ? 'numeric' : undefined
                }) + ' at ' + deadlineDate.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
            }
            
            return { text, class: cssClass };
        }
        
        // Get deadline CSS class
        function getDeadlineClass(deadline, completed) {
            if (completed || !deadline) return '';
            
            const now = new Date();
            const deadlineDate = new Date(deadline);
            const diff = deadlineDate - now;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            
            if (diff < 0) return 'overdue';
            if (days === 0) return 'due-today';
            if (days <= 7) return 'due-soon';
            return '';
        }
        
        // Sort tasks
        function sortTasks(tasks, order) {
            const sorted = [...tasks];
            
            switch (order) {
                case 'deadline-asc':
                    return sorted.sort((a, b) => {
                        if (!a.deadline) return 1;
                        if (!b.deadline) return -1;
                        return new Date(a.deadline) - new Date(b.deadline);
                    });
                case 'deadline-desc':
                    return sorted.sort((a, b) => {
                        if (!a.deadline) return 1;
                        if (!b.deadline) return -1;
                        return new Date(b.deadline) - new Date(a.deadline);
                    });
                case 'priority-high':
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    return sorted.sort((a, b) => priorityOrder[b.priority] - priorityOrder[a.priority]);
                case 'priority-low':
                    const priorityOrderLow = { high: 3, medium: 2, low: 1 };
                    return sorted.sort((a, b) => priorityOrderLow[a.priority] - priorityOrderLow[b.priority]);
                case 'created-desc':
                    return sorted.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                case 'created-asc':
                    return sorted.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
                default:
                    return sorted;
            }
        }
        
        // Handle toggle complete
        function handleToggleComplete(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                task.updatedAt = new Date().toISOString();
                saveTasks();
                renderTasks();
                updateStatistics();
                
                showToast(
                    task.completed ? 'Task marked as completed!' : 'Task marked as active!',
                    'success'
                );
            }
        }
        
        // Handle edit task
        function handleEditTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (!task) return;
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal">
                    <div class="modal-header">
                        <h3 class="modal-title">Edit Task</h3>
                        <button class="modal-close" aria-label="Close modal">&times;</button>
                    </div>
                    <form id="editTaskForm" class="form-grid">
                        <div class="form-group">
                            <label for="editTaskTitle" class="form-label required">Task Title</label>
                            <input 
                                type="text" 
                                id="editTaskTitle" 
                                class="form-input" 
                                value="${escapeHtml(task.title)}"
                                required
                                minlength="3"
                                maxlength="200"
                            >
                            <span class="form-error" id="editTitleError"></span>
                        </div>
                        
                        <div class="form-group">
                            <label for="editTaskEmail" class="form-label required">Email Address</label>
                            <input 
                                type="email" 
                                id="editTaskEmail" 
                                class="form-input" 
                                value="${escapeHtml(task.email)}"
                                required
                            >
                            <span class="form-error" id="editEmailError"></span>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="editTaskDescription" class="form-label">Description</label>
                            <textarea 
                                id="editTaskDescription" 
                                class="form-textarea"
                            >${escapeHtml(task.description || '')}</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="editTaskDeadlineDate" class="form-label">Deadline Date</label>
                            <input 
                                type="date" 
                                id="editTaskDeadlineDate" 
                                class="form-input"
                                value="${task.deadline ? task.deadline.split('T')[0] : ''}"
                            >
                        </div>
                        
                        <div class="form-group">
                            <label for="editTaskDeadlineTime" class="form-label">Deadline Time</label>
                            <input 
                                type="time" 
                                id="editTaskDeadlineTime" 
                                class="form-input"
                                value="${task.deadline ? task.deadline.split('T')[1].substring(0, 5) : ''}"
                            >
                        </div>
                        
                        <div class="form-group">
                            <label for="editTaskPriority" class="form-label">Priority</label>
                            <select id="editTaskPriority" class="form-select">
                                <option value="low" ${task.priority === 'low' ? 'selected' : ''}>Low</option>
                                <option value="medium" ${task.priority === 'medium' ? 'selected' : ''}>Medium</option>
                                <option value="high" ${task.priority === 'high' ? 'selected' : ''}>High</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width modal-actions">
                            <button type="button" class="btn btn-secondary" id="cancelEdit">Cancel</button>
                            <button type="submit" class="btn btn-primary">Update Task</button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Focus first input
            setTimeout(() => document.getElementById('editTaskTitle').focus(), 100);
            
            // Event listeners
            const closeBtn = modal.querySelector('.modal-close');
            const cancelBtn = modal.querySelector('#cancelEdit');
            const form = modal.querySelector('#editTaskForm');
            
            const closeModal = () => {
                modal.remove();
            };
            
            closeBtn.addEventListener('click', closeModal);
            cancelBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
            
            // ESC key to close
            const handleEsc = (e) => {
                if (e.key === 'Escape') {
                    closeModal();
                    document.removeEventListener('keydown', handleEsc);
                }
            };
            document.addEventListener('keydown', handleEsc);
            
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const title = document.getElementById('editTaskTitle').value.trim();
                const email = document.getElementById('editTaskEmail').value.trim();
                const description = document.getElementById('editTaskDescription').value.trim();
                const deadlineDate = document.getElementById('editTaskDeadlineDate').value;
                const deadlineTime = document.getElementById('editTaskDeadlineTime').value;
                const priority = document.getElementById('editTaskPriority').value;
                
                // Validate
                if (!validateEditForm(title, email)) {
                    return;
                }
                
                // Create deadline
                let deadline = null;
                if (deadlineDate) {
                    const timeStr = deadlineTime || '23:59';
                    deadline = new Date(`${deadlineDate}T${timeStr}:00`).toISOString();
                }
                
                // Update task
                task.title = title;
                task.email = email;
                task.description = description;
                task.deadline = deadline;
                task.priority = priority;
                task.updatedAt = new Date().toISOString();
                
                saveTasks();
                renderTasks();
                updateStatistics();
                closeModal();
                document.removeEventListener('keydown', handleEsc);
                
                showToast('Task updated successfully!', 'success');
            });
        }
        
        // Validate edit form
        function validateEditForm(title, email) {
            let isValid = true;
            
            // Clear errors
            document.getElementById('editTitleError').textContent = '';
            document.getElementById('editEmailError').textContent = '';
            
            // Validate title
            if (title.length < 3) {
                document.getElementById('editTitleError').textContent = 'Title must be at least 3 characters';
                isValid = false;
            } else if (title.length > 200) {
                document.getElementById('editTitleError').textContent = 'Title must be less than 200 characters';
                isValid = false;
            }
            
            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                document.getElementById('editEmailError').textContent = 'Please enter a valid email address';
                isValid = false;
            }
            
            return isValid;
        }
        
        // Handle delete task
        function handleDeleteTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (!task) return;
            
            // Create confirmation modal
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal" style="max-width: 400px;">
                    <div class="modal-header">
                        <h3 class="modal-title">Delete Task</h3>
                        <button class="modal-close" aria-label="Close modal">&times;</button>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <p>Are you sure you want to delete this task?</p>
                        <p style="margin-top: 8px; font-weight: 600; color: var(--color-slate-900);">${escapeHtml(task.title)}</p>
                        <p style="margin-top: 8px; font-size: 12px; color: var(--color-text-secondary);">This action cannot be undone.</p>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-secondary" id="cancelDelete">Cancel</button>
                        <button class="btn btn-primary" id="confirmDelete" style="background: #ef4444;">Delete</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Focus delete button
            setTimeout(() => document.getElementById('confirmDelete').focus(), 100);
            
            const closeBtn = modal.querySelector('.modal-close');
            const cancelBtn = modal.querySelector('#cancelDelete');
            const confirmBtn = modal.querySelector('#confirmDelete');
            
            const closeModal = () => {
                modal.remove();
            };
            
            closeBtn.addEventListener('click', closeModal);
            cancelBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
            
            // ESC key to close
            const handleEsc = (e) => {
                if (e.key === 'Escape') {
                    closeModal();
                    document.removeEventListener('keydown', handleEsc);
                }
            };
            document.addEventListener('keydown', handleEsc);
            
            confirmBtn.addEventListener('click', () => {
                tasks = tasks.filter(t => t.id !== taskId);
                saveTasks();
                renderTasks();
                updateStatistics();
                closeModal();
                document.removeEventListener('keydown', handleEsc);
                
                showToast('Task deleted successfully!', 'success');
            });
        }
        
        // Update statistics
        function updateStatistics() {
            const total = tasks.length;
            const active = tasks.filter(t => !t.completed).length;
            const completed = tasks.filter(t => t.completed).length;
            const overdue = tasks.filter(t => {
                if (t.completed || !t.deadline) return false;
                return new Date(t.deadline) < new Date();
            }).length;
            
            document.getElementById('statTotal').textContent = total;
            document.getElementById('statActive').textContent = active;
            document.getElementById('statCompleted').textContent = completed;
            document.getElementById('statOverdue').textContent = overdue;
        }
        
        // Show toast notification
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <span class="toast-icon">${type === 'success' ? '✓' : '✕'}</span>
                <span class="toast-message">${escapeHtml(message)}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideInRight var(--duration-normal) reverse';
                setTimeout(() => toast.remove(), 250);
            }, 3000);
        }
        
        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Console log for debugging
        console.log('Task Manager initialized with', tasks.length, 'tasks');
    </script>
</body>
</html>